<div layout="column">
    <div layout="row">
        <md-button class="md-primary" ng-click="$ctrl.selectFiles()">
            <i class="fa fa-fw fa-plus"></i>
            files
        </md-button>
    </div>
    <div layout="column" flex="45">
        <div layout="row" layout-align="start center">
            <h4 class="md-title">Samples ({{$ctrl.task.template.output_samples.length}})</h4>
            <md-button class="md-primary" ng-click="$ctrl.addSample()">add sample</md-button>
            <md-button class="md-primary" ng-click="$ctrl.addMultipleSamples()">Add Multiple Samples</md-button>
        </div>
        <p>
            The names of the samples you are creating will appear below. All samples will share the same setup
            properties.
        </p>
        <md-content style="maxx-height:20vh; minx-height:5vh">
            <div ng-repeat="sample in $ctrl.task.template.output_samples">
                <div layout="row">
                    <label>{{::$index+1}}.</label>
                    <input type="text" class="mc-input-as-line"
                           flex="85" ng-model="sample.name"
                           ng-model-options="{updateOn: 'default blur', debounce:{default: 1000, blur: 0}}"
                           ng-change="$ctrl.updateSampleName(sample)"
                           on-enter="$ctrl.addSample()"
                           placeholder="Untitled Sample..." id="{{::sample.id}}">
                    <a class="mc-error-color margin-top-10" ng-click="$ctrl.remove($index)">
                        <i class="fa fa-fw fa-remove"></i>
                    </a>
                </div>
            </div>
        </md-content>
    </div>

    <span flex></span>
    <div layout="column" flex="45" class="margin-top-10">
        <process-settings settings="$ctrl.task.template.setup[0].properties"
                          attribute="$ctrl.task.template.setup[0].attribute"
                          template-id="$ctrl.task.template.template_id"
                          task-id="$ctrl.task.id">
        </process-settings>
    </div>

    <span flex></span>
    <div layout="column" flex="45" class="margin-top-10">
        <process-measurements measurements="$ctrl.task.template.measurements"
                              process-id="$ctrl.task.process_id"
                              samples="$ctrl.task.template.output_samples"
                              template="$ctrl.task.template">
        </process-measurements>
    </div>

    <mc-process-template-samples-list process="$ctrl.task.template"></mc-process-template-samples-list>
    <mc-process-template-files-list process="$ctrl.task.template"></mc-process-template-files-list>

    <div flex="100" layout-margin ng-if="false">
        <md-table-container>
            <table md-table
                   ng-if="$ctrl.task.template.output_samples.length || $ctrl.task.template.input_files.length || $ctrl.task.template.output_files.length">
                <thead md-head>
                <tr md-row>
                    <th md-column>Type</th>
                    <th md-column>Name</th>
                    <th md-column></th>
                    <th md-column></th>
                </tr>
                </thead>
                <tbody>
                <tr md-row ng-repeat="sample in $ctrl.task.template.output_samples | orderBy:'name'">
                    <td md-cell>Sample</td>
                    <td md-cell>{{sample.name}}</td>
                    <td md-cell>
                        <a ng-if="$ctrl.task.template.input_files.length || $ctrl.task.template.output_files.length"
                           ng-click="$ctrl.linkFilesToSample(sample, $ctrl.task.template.input_files, $ctrl.task.template.output_files)">
                            Link Files
                        </a>
                        <ul class="list-unstyled">
                            <li ng-repeat="file in sample.files">
                                {{file.name}}
                            </li>
                        </ul>
                    </td>
                    <td md-cell>
                        <a ng-click="$ctrl.remove($ctrl.task.template.output_samples, sample)">
                            <i class="fa fa-close"></i>
                        </a>
                    </td>
                </tr>
                <tr md-row ng-repeat="file in $ctrl.task.template.input_files | orderBy:'name'">
                    <td md-cell>Input File</td>
                    <td md-cell>{{file.name}}</td>
                    <td md-cell></td>
                    <td md-cell>
                        <a ng-click="$ctrl.remove($ctrl.task.template.input_files, file)">
                            <i class="fa fa-close"></i>
                        </a>
                    </td>
                </tr>
                <tr md-row ng-repeat="file in $ctrl.task.template.output_files | orderBy:'name'">
                    <td md-cell>Output File</td>
                    <td md-cell>{{file.name}}</td>
                    <td md-cell></td>
                    <td md-cell>
                        <a ng-click="$ctrl.remove($ctrl.task.template.output_files, file)">
                            <i class="fa fa-close"></i>
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
        </md-table-container>
    </div>
</div>
