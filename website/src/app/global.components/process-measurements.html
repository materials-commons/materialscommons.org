<div layout="column">
    <h4 class="md-title">Measurements</h4>
    <md-content layout-padding>
        <form name="measurementsForm">
            <div ng-repeat="measurement in $ctrl.measurements">
                <div ng-switch="::measurement.property._type">

                    <!--------- number --------->
                    <div ng-switch-when="number">
                        <div layout="row" layout-align="start center">
                            <md-input-container md-no-float>
                                <label>{{::measurement.property.name}}</label>
                                <input type="number"
                                       name="numberInput"
                                       step="any"
                                       ng-change="$ctrl.updateMeasurementProperty(measurement.property)"
                                       ng-required="::measurement.property.required"
                                       ng-model="measurement.property.value">
                            </md-input-container>
                            <span ng-if="measurement.property.units.length === 0" class="unit-align">
                                {{::measurement.property.unit}}
                            </span>
                            <span ng-if="measurement.property.units.length !== 0">
                                <md-select ng-model="measurement.property.unit"
                                           ng-change="$ctrl.updateMeasurementProperty(measurement.property)"
                                           aria-label="units"
                                           class="units-align">
                                    <md-option ng-repeat="unit in ::measurement.property.units"
                                               ng-value="unit">
                                        {{unit}}
                                    </md-option>
                                </md-select>
                            </span>
                        </div>
                    </div>

                    <!------ composition ----->
                    <div ng-switch-when="composition">
                        <label>Composition</label>
                        <periodic-table composition="measurement.property"></periodic-table>
                    </div>

                    <!--------- date --------->
                    <div ng-switch-when="date">
                        <label>{{::measurement.property.name}}</label>
                        <md-datepicker ng-model="measurement.property.value"
                                       ng-change="$ctrl.updateMeasurementProperty(measurement.property)">
                        </md-datepicker>
                    </div>

                    <!--------- selection --------->
                    <div ng-switch-when="selection">
                        <div style="margin-top:45px">
                            <md-input-container class="md-block">
                                <label>{{::measurement.property.name}}</label>
                                <md-select ng-model="measurement.property.value"
                                           ng-model-options="{trackBy: '$value.name'}"
                                           ng-change="$ctrl.updateMeasurementProperty(measurement.property)"
                                           aria-label="x">
                                    <md-option ng-value="choice"
                                               ng-repeat="choice in ::measurement.property.choices">
                                        {{::choice.name}}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div ng-if="measurement.property.value.name === 'Other'">
                            <div style="margin-top:45px">
                                <md-input-container class="md-block" md-no-float>
                                    <label>Specify {{::measurement.property.name}}...</label>
                                    <input ng-model="measurement.property.value.value"
                                           ng-model-options="{debounce: 500}"
                                           ng-change="$ctrl.updateMeasurementProperty(measurement.property)"
                                           type="text">
                                </md-input-container>
                            </div>
                        </div>
                    </div>

                    <!--------- string --------->
                    <div ng-switch-when="string">
                        <md-input-container class="md-block">
                            <label>{{::measurement.property.name}}</label>
                            <input type="text" name="stringInput"
                                   ng-required="::measurement.property.required"
                                   ng-model-options="{debounce: 500}"
                                   ng-change="$ctrl.updateMeasurementProperty(measurement.property)"
                                   ng-model="measurement.property.value">
                        </md-input-container>
                    </div>

                    <!--------- unknown type --------->
                    <div ng-switch-default>
                        <span>Unknown type {{::measurement.property._type}}</span>
                    </div>
                </div>
            </div>
        </form>
    </md-content>
</div>